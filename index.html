<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hindi Real News</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#d32f2f">

<style>
body{margin:0;font-family:Arial,sans-serif;background:#f2f2f2}
header{background:#d32f2f;color:#fff;padding:15px;text-align:center}
input{width:95%;padding:10px;margin:10px auto;display:block;border-radius:5px;border:1px solid #ccc}
.news{background:#fff;margin:10px;border-radius:8px;overflow:hidden;box-shadow:0 2px 5px rgba(0,0,0,.1)}
.news img{width:100%;height:180px;object-fit:cover;background:#eee}
.news-content{padding:12px}
.news h3{margin:0;font-size:16px}
.source{font-size:12px;color:#666;margin:6px 0}
.news a{color:#d32f2f;text-decoration:none;font-weight:bold}
.loading{text-align:center;padding:20px;color:#777}
footer{text-align:center;padding:10px;font-size:12px;color:#777}
</style>
</head>

<body>

<header>
  <h2>üì∞ Hindi Real News</h2>
  <p>AajTak | BBC | NDTV</p>
</header>

<input type="text" id="search" placeholder="‡§®‡•ç‡§Ø‡•Ç‡§ú‡§º ‡§ñ‡•ã‡§ú‡•á‡§Ç..." onkeyup="filterNews()">

<div id="newsContainer"><div class="loading">‡§®‡•ç‡§Ø‡•Ç‡§ú‡§º ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à...</div></div>

<footer>Live Hindi News ‚Ä¢ Image Working ‚Ä¢ GitHub Pages Ready</footer>

<script>
// RSS feeds
const feeds = [
  { name:"AajTak", url:"https://www.aajtak.in/rssfeeds/?id=home" },
  { name:"BBC Hindi", url:"https://feeds.bbci.co.uk/hindi/rss.xml" },
  { name:"NDTV Hindi", url:"https://feeds.feedburner.com/ndtvkhabar" }
];

// Text proxy (RSS)
const textProxy = "https://api.allorigins.win/raw?url=";

// Image proxy (üî• working)
function imgProxy(url){
  return "https://images.weserv.nl/?url=" + encodeURIComponent(url);
}

let allNews = [];

// Extract image
function getImage(item){
  const media = item.getElementsByTagName("media:content")[0];
  if(media && media.getAttribute("url")) return media.getAttribute("url");

  const enc = item.getElementsByTagName("enclosure")[0];
  if(enc && enc.getAttribute("url")) return enc.getAttribute("url");

  const desc = item.querySelector("description")?.textContent || "";
  const match = desc.match(/<img[^>]+src="([^">]+)"/);
  if(match) return match[1];

  return "";
}

async function loadNews(){
  allNews = [];
  const box = document.getElementById("newsContainer");
  box.innerHTML = '<div class="loading">‡§®‡•ç‡§Ø‡•Ç‡§ú‡§º ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à...</div>';

  await Promise.all(feeds.map(async feed=>{
    try{
      const res = await fetch(textProxy + encodeURIComponent(feed.url));
      const text = await res.text();
      const xml = new DOMParser().parseFromString(text,"text/xml");
      const items = xml.querySelectorAll("item");

      items.forEach(item=>{
        const title = item.querySelector("title")?.textContent || "";
        const link  = item.querySelector("link")?.textContent || "";
        const image = getImage(item);

        if(title.length > 10){
          allNews.push({title,link,image,source:feed.name});
        }
      });
    }catch(e){}
  }));

  renderNews(allNews);
}

function renderNews(list){
  const box = document.getElementById("newsContainer");
  box.innerHTML = "";

  list.slice(0,50).forEach(n=>{
    const img = n.image ? imgProxy(n.image) : "https://via.placeholder.com/400x200?text=Hindi+News";

    const div = document.createElement("div");
    div.className = "news";
    div.innerHTML = `
      <img loading="lazy" src="${img}"
           onerror="this.src='https://via.placeholder.com/400x200?text=Hindi+News'">
      <div class="news-content">
        <h3>${n.title}</h3>
        <div class="source">Source: ${n.source}</div>
        <a href="${n.link}" target="_blank">‡§™‡•Ç‡§∞‡§æ ‡§™‡§¢‡§º‡•á‡§Ç ‚Üí</a>
      </div>
    `;
    box.appendChild(div);
  });
}

function filterNews(){
  const q = search.value.toLowerCase();
  renderNews(allNews.filter(n=>n.title.toLowerCase().includes(q)));
}

loadNews();
</script>

</body>
</html>
