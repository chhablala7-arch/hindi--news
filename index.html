<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hindi Real News</title>

<!-- PWA META -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#d32f2f">

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#f2f2f2;
}
header{
  background:#d32f2f;
  color:#fff;
  padding:15px;
  text-align:center;
}
input{
  width:95%;
  padding:10px;
  margin:10px auto;
  display:block;
  border-radius:5px;
  border:1px solid #ccc;
}
.news{
  background:#fff;
  margin:10px;
  border-radius:8px;
  overflow:hidden;
  box-shadow:0 2px 5px rgba(0,0,0,.1);
}
.news img{
  width:100%;
  height:180px;
  object-fit:cover;
  background:#eee;
}
.news-content{
  padding:12px;
}
.news h3{
  margin:0;
  font-size:16px;
}
.source{
  font-size:12px;
  color:#666;
  margin:6px 0;
}
.news a{
  color:#d32f2f;
  text-decoration:none;
  font-weight:bold;
}
.loading{
  text-align:center;
  padding:20px;
  color:#777;
}
footer{
  text-align:center;
  padding:10px;
  font-size:12px;
  color:#777;
}
</style>
</head>

<body>

<header>
  <h2>üì∞ Hindi Real News</h2>
  <p>AajTak | BBC | NDTV</p>
</header>

<input type="text" id="search" placeholder="‡§®‡•ç‡§Ø‡•Ç‡§ú‡§º ‡§ñ‡•ã‡§ú‡•á‡§Ç..." onkeyup="filterNews()">

<div id="newsContainer">
  <div class="loading">‡§®‡•ç‡§Ø‡•Ç‡§ú‡§º ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à...</div>
</div>

<footer>
  Live Hindi News ‚Ä¢ Image Support ‚Ä¢ GitHub Pages Ready
</footer>

<script>
// RSS FEEDS
const feeds = [
  { name:"AajTak", url:"https://www.aajtak.in/rssfeeds/?id=home" },
  { name:"BBC Hindi", url:"https://feeds.bbci.co.uk/hindi/rss.xml" },
  { name:"NDTV Hindi", url:"https://feeds.feedburner.com/ndtvkhabar" }
];

// CORS PROXY
const proxy = "https://api.allorigins.win/raw?url=";

let allNews = [];

// IMAGE EXTRACT FUNCTION
function getImage(item){
  // 1Ô∏è‚É£ media:content
  const media = item.getElementsByTagName("media:content")[0];
  if(media && media.getAttribute("url")) return media.getAttribute("url");

  // 2Ô∏è‚É£ enclosure
  const enc = item.getElementsByTagName("enclosure")[0];
  if(enc && enc.getAttribute("url")) return enc.getAttribute("url");

  // 3Ô∏è‚É£ img from description
  const desc = item.querySelector("description")?.textContent || "";
  const match = desc.match(/<img[^>]+src="([^">]+)"/);
  if(match) return match[1];

  // fallback image
  return "https://via.placeholder.com/400x200?text=Hindi+News";
}

// LOAD NEWS
async function loadNews(){
  allNews = [];
  const box = document.getElementById("newsContainer");
  box.innerHTML = '<div class="loading">‡§®‡•ç‡§Ø‡•Ç‡§ú‡§º ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à...</div>';

  for(const feed of feeds){
    try{
      const res = await fetch(proxy + encodeURIComponent(feed.url));
      if(!res.ok) throw new Error();

      const text = await res.text();
      const xml = new DOMParser().parseFromString(text,"text/xml");
      const items = xml.querySelectorAll("item");

      items.forEach(item=>{
        const title = item.querySelector("title")?.textContent || "";
        const link  = item.querySelector("link")?.textContent || "";
        const image = getImage(item);

        if(title.length > 10 && link.startsWith("http")){
          allNews.push({
            title,
            link,
            image,
            source: feed.name
          });
        }
      });

    }catch(e){
      console.log("Error loading:", feed.name);
    }
  }

  renderNews(allNews);
}

// RENDER
function renderNews(list){
  const box = document.getElementById("newsContainer");
  box.innerHTML = "";

  if(list.length === 0){
    box.innerHTML = "<div class='loading'>‡§ï‡•ã‡§à ‡§®‡•ç‡§Ø‡•Ç‡§ú‡§º ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡•Ä</div>";
    return;
  }

  list.slice(0,50).forEach(n=>{
    const div = document.createElement("div");
    div.className = "news";
    div.innerHTML = `
      <img src="${n.image}" onerror="this.src='https://via.placeholder.com/400x200?text=Hindi+News'">
      <div class="news-content">
        <h3>${n.title}</h3>
        <div class="source">Source: ${n.source}</div>
        <a href="${n.link}" target="_blank">‡§™‡•Ç‡§∞‡§æ ‡§™‡§¢‡§º‡•á‡§Ç ‚Üí</a>
      </div>
    `;
    box.appendChild(div);
  });
}

// SEARCH
function filterNews(){
  const q = document.getElementById("search").value.toLowerCase();
  const filtered = allNews.filter(n => n.title.toLowerCase().includes(q));
  renderNews(filtered);
}

loadNews();
setInterval(loadNews, 600000);
</script>

</body>
</html>
